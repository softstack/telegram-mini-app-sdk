{"version":3,"file":"TypedEvent.js","sourceRoot":"","sources":["../../src/TypedEvent.ts"],"names":[],"mappings":";;;AAAA,iCAAyC;AACzC,yCAAsC;AAOtC,MAAa,UAAU;IAAvB;QAOS,YAAO,GAAG,IAAI,WAAW,EAAE,CAAC;QAS5B,eAAU,GAAG,IAAI,mBAAQ,EAI9B,CAAC;QAMI,cAAS,GAAG,KAAK,CAAC;IAqH3B,CAAC;IA7GA,EAAE,CACD,SAAoB,EACpB,QAAoD;QAEpD,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;YACrB,MAAM,aAAa,GAAG,IAAA,sBAAe,EAAC,QAAQ,CAAC,CAAC;YAChD,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;YACxD,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,EAAE,QAAkE,EAAE,aAAa,CAAC,CAAC;QACnH,CAAC;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IASD,IAAI,CACH,SAAoB,EACpB,QAAoD;QAEpD,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;YACrB,MAAM,aAAa,GAAG,IAAA,sBAAe,EAAC,QAAQ,CAAC,CAAC;YAChD,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,SAAS,EAAE,aAAa,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;YACxE,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,EAAE,QAAkE,EAAE,aAAa,CAAC,CAAC;QACnH,CAAC;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAQD,GAAG,CACF,SAAoB,EACpB,QAAoD;QAEpD,OAAO,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;IACjD,CAAC;IAQD,cAAc,CACb,SAAoB,EACpB,QAAoD;QAEpD,MAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CACxC,SAAS,EACT,QAAkE,CAClE,CAAC;QACF,IAAI,aAAa,EAAE,CAAC;YACnB,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;YAC3D,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,EAAE,QAAkE,CAAC,CAAC;QACvG,CAAC;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAUD,kBAAkB,CAA0C,SAAqB;QAChF,KAAK,MAAM,CAAC,IAAI,EAAE,QAAQ,EAAE,aAAa,CAAC,IAAI,IAAI,CAAC,UAAU,EAAE,CAAC;YAC/D,IAAI,CAAC,SAAS,IAAI,IAAI,KAAK,SAAS,EAAE,CAAC;gBACtC,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;gBACtD,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;YACxC,CAAC;QACF,CAAC;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAOS,OAAO;QAChB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC3B,CAAC;IAUS,IAAI,CACb,SAAoB,EACpB,aAAgC;QAEhC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;YACrB,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,WAAW,CAAC,SAAS,EAAE,EAAE,MAAM,EAAE,aAAa,EAAE,CAAC,CAAC,CAAC;QACnF,CAAC;IACF,CAAC;CACD;AA/ID,gCA+IC","sourcesContent":["import { toEventListener } from './base';\nimport { TupleMap } from './TupleMap';\n\n/**\n * A class that provides strongly-typed event handling.\n * @template Events - A record of event names to event argument types.\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport class TypedEvent<Events extends Record<string, any>> {\n\t/**\n\t * An instance of `EventTarget` used to manage event listeners and dispatch events.\n\t * This private property is used internally to handle event-related operations.\n\t *\n\t * @private\n\t */\n\tprivate _target = new EventTarget();\n\t/**\n\t * A map of event listeners where the key is a string representing the event name,\n\t * and the value is a tuple containing two functions:\n\t * - The first function takes an event argument of type `Events[keyof Events & string]` and returns void.\n\t * - The second function takes an `Event` object and returns void.\n\t *\n\t * @private\n\t */\n\tprivate _listeners = new TupleMap<\n\t\tkeyof Events & string,\n\t\t(eventArgument: Events[keyof Events & string]) => void,\n\t\t(event: Event) => void\n\t>();\n\t/**\n\t * A flag indicating whether the event has been disposed.\n\t *\n\t * @private\n\t */\n\tprivate _disposed = false;\n\n\t/**\n\t * Registers an event listener for the specified event.\n\t * @param eventName - The name of the event to listen for.\n\t * @param listener - The callback function to invoke when the event is fired.\n\t * @returns The current instance for chaining.\n\t */\n\ton<EventName extends keyof Events & string>(\n\t\teventName: EventName,\n\t\tlistener: (eventArgument: Events[EventName]) => void,\n\t): this {\n\t\tif (!this._disposed) {\n\t\t\tconst eventListener = toEventListener(listener);\n\t\t\tthis._target.addEventListener(eventName, eventListener);\n\t\t\tthis._listeners.set(eventName, listener as (eventArgument: Events[keyof Events & string]) => void, eventListener);\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Registers a one-time event listener for the specified event.\n\t * The listener is automatically removed after it is invoked once.\n\t * @param eventName - The name of the event to listen for.\n\t * @param listener - The callback function to invoke when the event is fired.\n\t * @returns The current instance for chaining.\n\t */\n\tonce<EventName extends keyof Events & string>(\n\t\teventName: EventName,\n\t\tlistener: (eventArgument: Events[EventName]) => void,\n\t): this {\n\t\tif (!this._disposed) {\n\t\t\tconst eventListener = toEventListener(listener);\n\t\t\tthis._target.addEventListener(eventName, eventListener, { once: true });\n\t\t\tthis._listeners.set(eventName, listener as (eventArgument: Events[keyof Events & string]) => void, eventListener);\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Removes an event listener for the specified event.\n\t * @param eventName - The name of the event.\n\t * @param listener - The callback function to remove.\n\t * @returns The current instance for chaining.\n\t */\n\toff<EventName extends keyof Events & string>(\n\t\teventName: EventName,\n\t\tlistener: (eventArgument: Events[EventName]) => void,\n\t): this {\n\t\treturn this.removeListener(eventName, listener);\n\t}\n\n\t/**\n\t * Removes an event listener for the specified event.\n\t * @param eventName - The name of the event.\n\t * @param listener - The callback function to remove.\n\t * @returns The current instance for chaining.\n\t */\n\tremoveListener<EventName extends keyof Events & string>(\n\t\teventName: EventName,\n\t\tlistener: (eventArgument: Events[EventName]) => void,\n\t): this {\n\t\tconst eventListener = this._listeners.get(\n\t\t\teventName,\n\t\t\tlistener as (eventArgument: Events[keyof Events & string]) => void,\n\t\t);\n\t\tif (eventListener) {\n\t\t\tthis._target.removeEventListener(eventName, eventListener);\n\t\t\tthis._listeners.delete(eventName, listener as (eventArgument: Events[keyof Events & string]) => void);\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Removes all listeners for the specified event name. If no event name is provided,\n\t * it removes all listeners for all events.\n\t *\n\t * @template EventName - The type of the event name.\n\t * @param {EventName} [eventName] - The name of the event for which to remove all listeners.\n\t * @returns {this} The current instance for chaining.\n\t */\n\tremoveAllListeners<EventName extends keyof Events & string>(eventName?: EventName): this {\n\t\tfor (const [name, listener, eventListener] of this._listeners) {\n\t\t\tif (!eventName || name === eventName) {\n\t\t\t\tthis._target.removeEventListener(name, eventListener);\n\t\t\t\tthis._listeners.delete(name, listener);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Disposes of the current instance by marking it as disposed and removing all listeners.\n\t *\n\t * @protected\n\t */\n\tprotected dispose(): void {\n\t\tthis._disposed = true;\n\t\tthis.removeAllListeners();\n\t}\n\n\t/**\n\t * Emits a custom event with the specified name and argument.\n\t *\n\t * @template EventName - The type of the event name, which must be a key of the `Events` interface and a string.\n\t * @param eventName - The name of the event to emit.\n\t * @param eventArgument - The argument to pass with the event, corresponding to the event name.\n\t * @returns void\n\t */\n\tprotected emit<EventName extends keyof Events & string>(\n\t\teventName: EventName,\n\t\teventArgument: Events[EventName],\n\t): void {\n\t\tif (!this._disposed) {\n\t\t\tthis._target.dispatchEvent(new CustomEvent(eventName, { detail: eventArgument }));\n\t\t}\n\t}\n}\n"]}